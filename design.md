# UV Shade Map - デザイン設計書

## アプリ概要

紫外線（UV）による肌への影響を可視化し、研究に基づいた日陰を優先するルート案内を提供するモバイルアプリ。一般ユーザー向けに設計され、iPhoneのマップのような直感的な操作感を実現する。

## 画面リスト

| 画面名 | 説明 |
|--------|------|
| **ホーム（マップ）** | メイン画面。現在地を中心とした地図表示。UV指数と日陰情報をオーバーレイ表示。 |
| **ルート検索** | 目的地を入力し、日陰優先ルートを検索する画面。 |
| **設定** | 肌タイプの選択、表示モードの切替、通知設定など。 |

## 主要コンテンツと機能

### ホーム（マップ）画面
- **現在地表示**: GPS位置情報を取得し、地図の中心に表示
- **UV指数カード**: 画面上部に現在のUV指数を大きく表示（0-11+のスケール）
- **肌への影響インジケーター**: UV指数に基づいた肌へのリスクレベル（低/中/高/非常に高/極端）
- **表示モード切替ボタン**: 
  - 標準マップ（iPhoneマップ風）
  - UVヒートマップ（紫外線強度を色で可視化）
  - 日陰マップ（建物の影をリアルタイムで表示）
- **ルート検索ボタン**: 目的地入力画面への遷移

### ルート検索画面
- **検索バー**: 目的地の住所や場所名を入力
- **最近の検索履歴**: 過去の検索結果を表示
- **ルート表示**: 日陰を優先したルートを地図上に描画
- **ルート比較**: 最短ルート vs 日陰優先ルートの比較情報

### 設定画面
- **肌タイプ選択**: フィッツパトリック分類（I-VI）に基づく肌タイプ
- **表示設定**: デフォルトの地図表示モード
- **通知設定**: UV指数が高い時のアラート

## キーユーザーフロー

### フロー1: UV指数の確認
1. アプリを起動
2. 現在地のUV指数がカードに表示される
3. 肌への影響レベルと推奨される対策を確認

### フロー2: 日陰マップの確認
1. ホーム画面で表示モード切替ボタンをタップ
2. 「日陰マップ」を選択
3. 現在時刻の建物の影が地図上に表示される
4. 時間スライダーで将来の影の変化を確認可能

### フロー3: 日陰優先ルート検索
1. ホーム画面でルート検索ボタンをタップ
2. 目的地を入力
3. 日陰優先ルートが表示される
4. ルートの詳細（距離、所要時間、日陰率）を確認
5. ナビゲーション開始

## カラーパレット

| 用途 | ライトモード | ダークモード | 説明 |
|------|-------------|-------------|------|
| **Primary** | #6366F1 (Indigo) | #818CF8 | メインアクセントカラー（UV保護を連想させる紫系） |
| **Background** | #FFFFFF | #0F172A | 画面背景 |
| **Surface** | #F1F5F9 | #1E293B | カード・パネル背景 |
| **Foreground** | #0F172A | #F8FAFC | メインテキスト |
| **Muted** | #64748B | #94A3B8 | サブテキスト |
| **Border** | #E2E8F0 | #334155 | 境界線 |
| **UV Low** | #22C55E | #4ADE80 | UV指数0-2（低） |
| **UV Moderate** | #EAB308 | #FACC15 | UV指数3-5（中） |
| **UV High** | #F97316 | #FB923C | UV指数6-7（高） |
| **UV Very High** | #EF4444 | #F87171 | UV指数8-10（非常に高） |
| **UV Extreme** | #A855F7 | #C084FC | UV指数11+（極端） |
| **Shade** | #1E3A5F (半透明) | #1E3A5F (半透明) | 日陰エリアの表示色 |

## UI/UXガイドライン

### Apple Human Interface Guidelines準拠
- **Large Title**: 画面タイトルは大きく、スクロールで縮小
- **Tab Bar**: 下部に配置、アイコン+ラベル
- **Cards**: 角丸16px、軽いシャドウ
- **Buttons**: 角丸フル（pill shape）、十分なタップ領域（44pt以上）
- **Typography**: SF Pro相当のフォント、適切な行間

### インタラクション
- **Haptic Feedback**: モード切替、ルート選択時に軽い振動
- **スムーズなアニメーション**: 画面遷移、カード展開は300ms以内
- **Pull to Refresh**: UV指数の手動更新

## 技術的な実装方針

### 地図表示
- **react-native-maps**: 基本的な地図表示とカスタムオーバーレイ
- **MapView with Polygon**: 日陰エリアの描画
- **Heatmap**: UV指数の可視化

### UV指数データ
- **OpenUV API**: リアルタイムのUV指数取得
- **キャッシュ**: 同一地点のデータは15分間キャッシュ

### 日陰計算
- **SunCalc**: 太陽の位置（高度・方位角）を計算
- **建物データ**: OpenStreetMap (Overpass API) から建物の形状と高さを取得
- **影の計算**: 太陽の位置と建物の高さから影の形状を算出

### ルート案内
- **OSRM / GraphHopper**: 基本的なルート計算
- **カスタム重み付け**: 日陰エリアを通過するルートにボーナスを付与
